FROM python:3.11.4-slim-buster AS base

ENV APP_HOME=/app
WORKDIR $APP_HOME
ENV PYTHONPATH=$APP_HOME

COPY requirements.txt .
RUN pip install --upgrade pip setuptools wheel
RUN pip install --no-cache -r requirements.txt

FROM base AS jupyter

COPY requirements-dev.txt .
RUN pip install -r requirements-dev.txt

COPY scripts/entrypoint-dev-jupyter.sh scripts/entrypoint-dev-jupyter.sh
RUN chmod +x scripts/entrypoint-dev-jupyter.sh

FROM base AS fastapi

COPY scripts/entrypoint-dev-fastapi.sh scripts/entrypoint-dev-fastapi.sh
RUN chmod +x scripts/entrypoint-dev-fastapi.sh